#Executing commands on remote servers
$Servers = Get-Content -Path "C:\Users\Documents\ComputerName.txt" # create file in your profile with name ComputerName.txt
#$Servers = @(" ", " ")
 
$Username = '' # provide A account user id
$Password = "" #provide A account password
$pass = ConvertTo-SecureString -AsPlainText $Password -Force
$Cred = New-Object System.Management.Automation.PSCredential -ArgumentList $Username,$pass
 
Get-PSSession | Remove-PSSession
New-PSSession -ComputerName $Servers
 
foreach($Server in $Servers){
#invoke a command on remote servers to suprass the vulnerability

# Registry modification
New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\LSA" -Name "RestrictAnonymous" -Value 1 -PropertyType DWORD -Force | Out-Null

Write-Host "Registry modification complete."

}
