#Executing commands on remote servers
$Servers = Get-Content -Path "C:\Users\Documents\ComputerName.txt" # create file in your profile with name ComputerName.txt
#$Servers = @(" ", " ")
 
$Username = '' # provide A account user id
$Password = "" #provide A account password
$pass = ConvertTo-SecureString -AsPlainText $Password -Force
$Cred = New-Object System.Management.Automation.PSCredential -ArgumentList $Username,$pass
 
Get-PSSession | Remove-PSSession
New-PSSession -ComputerName $Servers
 
foreach($Server in $Servers){
#invoke a command on remote servers to suprass the vulnerability

# Registry modifications
New-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\Explorer\" -Name "NoDriveTypeAutoRun" -Value 255 -PropertyType DWORD -Force | Out-Null
New-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer\" -Name "NoAutorun" -Value 1 -PropertyType DWORD -Force | Out-Null

Write-Host "Registry modifications complete."

}
